pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                script {
                    openshift.withCluster(){
                        openshift.withProject() {
                            openshift.startBuild("gitbook-centos-docker")
                    }
                }
            }
        }
        stage 'deploy'
            sh "oc rollout latest dc/gitbook-centos-docker"

        stage 'ask for promotion'
            input id: 'Approve01', message: 'Want to push to prod?', ok: 'Deploying to Prod!'

        stage 'tag and promote'
            sh "oc tag gitbook-centos-docker:latest gitbook-centos-docker:prod"
     }
   }
}
